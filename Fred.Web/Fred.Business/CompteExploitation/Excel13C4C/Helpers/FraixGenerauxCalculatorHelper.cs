using Fred.Web.Shared.Models.Budget.Recette;

namespace Fred.Business.CompteExploitation.Excel13C4C.Helpers
{
    public class FraixGenerauxCalculatorHelper
    {

        public decimal GetDiffMontantFraixGenerauxForMonth(AvancementRecetteLoadModel avancementRecetteLoadModel, AvancementRecetteLoadModel avancementRecetteLoadModelPrevious)
        {
            var montantFraixGeneraux = GetMontantFraixGenerauxForMonth(avancementRecetteLoadModel);
            var montantFraixGenerauxPrevious = GetMontantFraixGenerauxForMonth(avancementRecetteLoadModelPrevious);
            return montantFraixGeneraux - montantFraixGenerauxPrevious;
        }


        public decimal GetMontantFraixGenerauxForMonth(AvancementRecetteLoadModel avancementRecetteLoadModel)
        {
            if (avancementRecetteLoadModel == null)
            {
                return 0;
            }
            var prodCumul = GetProductionCumul(avancementRecetteLoadModel);
            var montantFraixGeneraux = avancementRecetteLoadModel.AvancementTauxFraisGeneraux * prodCumul / 100 + avancementRecetteLoadModel.AvancementAjustementFraisGeneraux;
            return montantFraixGeneraux;
        }


        private decimal GetProductionCumul(AvancementRecetteLoadModel avancementRecetteLoadModel)
        {
            if (avancementRecetteLoadModel == null)
            {
                return 0;
            }
            var prodcumul = avancementRecetteLoadModel.TotalAvancementFacture;
            return prodcumul;
        }

    }
}
