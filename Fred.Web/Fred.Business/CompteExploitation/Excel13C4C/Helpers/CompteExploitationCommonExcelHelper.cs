using System;
using System.Collections.Generic;
using Fred.Framework.Extensions;
using static Fred.Entities.Constantes;
namespace Fred.Business.CompteExploitation.Excel13C4C.Helpers
{
    public static class CompteExploitationCommonExcelHelper
    {

        private const string ExcelDateGeneration = "Date génération : {0}";
        private const string ExcelUpperTitle = "Compte d'Exploitation - {0} - {1} (en EUROS)";
        private const string Titledefaulttotal = "DES DEPENSES";

        public static Dictionary<string, string> FillStaticExcelMarkers(string period, string ciName, string etat, DateTime periodeFinM, string valFiltreLibelle)
        {

            var dateGeneration = DateTime.Now.ToString("dd/MM/yyyy H:mm:ss");

            Dictionary<string, string> perimeter = new Dictionary<string, string>
            {
                { AnalysisAxis.Chapitre, "Etat Partiel Chapitre"},
                { AnalysisAxis.SousChapitre, "Etat Partiel Sous-Chapitre"},
                { AnalysisAxis.T1, "Etat Partiel Regroupement T1"},
                { AnalysisAxis.T2, "Etat Partiel Regroupement T2"},
                { AnalysisAxis.Complet, "Etat Complet"}
            };

            var filledTitle = string.Format(ExcelUpperTitle, perimeter[etat], period);
            var filledDate = string.Format(ExcelDateGeneration, dateGeneration);
            var year = periodeFinM.ToString("yy");
            var month = periodeFinM.ToString("MMM").ToUpperFirstLetter();
            var totalLabel = string.IsNullOrEmpty(valFiltreLibelle) ? "TOTAL " + Titledefaulttotal : "Ss-total " + valFiltreLibelle;
            var cumulM1Header = periodeFinM.AddMonths(-1).ToString("MMM").ToUpperFirstLetter();

            return new Dictionary<string, string>
              {
                // Commun
                { "CI", ciName },
                { "DateGeneration", filledDate },
                { "Title", filledTitle },
                { "TotalLabel", totalLabel},
                { "TotalLabelFac", "TOTAL FACTURATION"},
                { "TotalLabelCorrect", "CORRECTIF"},
                { "TotalLabelProd","PRODUCTION"},
                { "MargeBrute","MARGE BRUTE"},
                { "FraisProP","FRAIS PROPORTIONNELS"},
                { "MargeNet","MARGE NETTE"},
                // Uniquement pour l'édition 13C
                { "M1Header", $"{periodeFinM.AddMonths(-11).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-11).ToString("yy")}" },
                { "M2Header", $"{periodeFinM.AddMonths(-10).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-10).ToString("yy")}" },
                { "M3Header", $"{periodeFinM.AddMonths(-9).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-9).ToString("yy")}" },
                { "M4Header", $"{periodeFinM.AddMonths(-8).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-8).ToString("yy")}" },
                { "M5Header", $"{periodeFinM.AddMonths(-7).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-7).ToString("yy")}" },
                { "M6Header", $"{periodeFinM.AddMonths(-6).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-6).ToString("yy")}" },
                { "M7Header", $"{periodeFinM.AddMonths(-5).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-5).ToString("yy")}" },
                { "M8Header", $"{periodeFinM.AddMonths(-4).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-4).ToString("yy")}" },
                { "M9Header", $"{periodeFinM.AddMonths(-3).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-3).ToString("yy")}" },
                { "M10Header", $"{periodeFinM.AddMonths(-2).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-2).ToString("yy")}" },
                { "M11Header", $"{periodeFinM.AddMonths(-1).ToString("MMM").ToUpperFirstLetter()}-{periodeFinM.AddMonths(-1).ToString("yy")}" },
                { "M12Header", $"{month}-{year}" },
                { "CumulHeader", $"Cumul {month}-{year}" },
                // Uniquement pour l'édition 4C
                { "CumulM1Header", $"Cumul {cumulM1Header}-{year}"},
                { "MHeader", $"{month}-{year}"},
                { "CumulMHeader",  $"Cumul {month}-{year}"},
                { "CumulFarHeader", $"Cumul FAR {month}-{year}"}
              };
        }

    }
}
