using System;
using Fred.Business.CI;
using Fred.Business.CompteExploitation.Excel13C4C.Managers.Interfaces;
using Fred.Business.Images;
using Fred.Entities.Image;
using Fred.Entities.Societe;

namespace Fred.Business.CompteExploitation.Excel13C4C.Managers
{
    public class ImageSocietePathManager : IImageSocietePathManager
    {
        private readonly ICIManager cIManager;
        private readonly IImageManager imageManager;

        public ImageSocietePathManager(ICIManager cIManager,
                                       IImageManager imageManager)
        {

            this.cIManager = cIManager;
            this.imageManager = imageManager;
        }

        public string GetImagePath(int ciId)
        {
            try
            {
                SocieteEnt cisociete = this.cIManager.GetSocieteByCIId(ciId);
                ImageEnt imageSoc = imageManager.GetLogoImage(cisociete.SocieteId);
                return imageSoc.Path;
            }
            catch (Exception e)
            {
                return string.Empty;
            }
        }
    }
}
