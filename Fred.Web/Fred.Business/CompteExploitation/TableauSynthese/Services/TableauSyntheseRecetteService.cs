using System;
using Fred.Business.CompteExploitation.TableauSynthese.Models;
using Fred.Web.Shared.Models.Budget.Recette;
namespace Fred.Business.CompteExploitation.TableauSynthese.Services
{
    public class TableauSyntheseRecetteService : ITableauSyntheseRecetteService
    {

        public TableauSyntheseRecetteExportModel GetRecetteExportData(AvancementRecetteLoadModel avancementRecette)
        {
            if (avancementRecette == null)
                throw new ArgumentNullException(nameof(avancementRecette));

            return new TableauSyntheseRecetteExportModel
            {
                BudgetMontantMarche = avancementRecette.BudgetRecette?.MontantMarche ?? 0,
                BudgetMontantAvenants = avancementRecette.BudgetRecette?.MontantAvenants ?? 0,
                BudgetSommeAValoir = avancementRecette.BudgetRecette?.SommeAValoir ?? 0,
                BudgetRevision = avancementRecette.BudgetRecette?.Revision ?? 0,
                BudgetTravauxSupplementaires = avancementRecette.BudgetRecette?.TravauxSupplementaires ?? 0,
                BudgetAutresRecettes = avancementRecette.BudgetRecette?.AutresRecettes ?? 0,
                BudgetPenalitesEtRetenues = avancementRecette.BudgetRecette?.PenalitesEtRetenues ?? 0,

                MoisMontantMarche = avancementRecette.MontantMarche,
                MoisMontantAvenants = avancementRecette.MontantAvenants,
                MoisSommeAValoir = avancementRecette.SommeAValoir,
                MoisRevision = avancementRecette.Revision,
                MoisTravauxSupplementaires = avancementRecette.TravauxSupplementaires,
                MoisAutresRecettes = avancementRecette.AutresRecettes,
                MoisPenalitesEtRetenues = avancementRecette.PenalitesEtRetenues,

                FinAffaireMontantMarche = avancementRecette.MontantMarchePFA,
                FinAffaireMontantAvenants = avancementRecette.MontantAvenantsPFA,
                FinAffaireSommeAValoir = avancementRecette.SommeAValoirPFA,
                FinAffaireRevision = avancementRecette.RevisionPFA,
                FinAffaireTravauxSupplementaires = avancementRecette.TravauxSupplementairesPFA,
                FinAffaireAutresRecettes = avancementRecette.AutresRecettesPFA,
                FinAffairePenalitesEtRetenues = avancementRecette.PenalitesEtRetenuesPFA,

                MoisCorrectif = avancementRecette.Correctif,
                FraisGeneraux = avancementRecette.TauxFraisGeneraux / 100,
            };
        }

    }
}
